1. Краткое описание инцидента

	В 22:52 UTC 21 октября 2018 г на нескольких сервисах GitHub.com пострадали несколько сетевых разделов, что привело в сбоям в работе базы данных и появлению непоследовательной информации на веб-сайте.

2. Предшествующие события 

	Плановые работы по техническому обслуживанию для замены вышедшего из строя оптического оборудования.

3. Причина инцидента 

	Плановые работы по техническому обслуживанию для замены вышедшего из строя оптического оборудования 100G привели к потере связи между сетевым узлом на Восточном побережье США и основным центром обработки данных на Восточном побережье США.

4. Воздействие 

	Сеть была восстановлена за 43 секунды, но это короткое отключение вызвало цепочку событий, которые привели к 24 часам и 11 минутам ухудшения качества обслуживания. А именно, изменилась топология репликации кластеров БД MySQL, и это привело к тому, что данные некоторые веб-служб не записывались (не сохранялись) в БД. В частности, не работали issues, pull requests, webhooks.

5. Обнаружение 

	В 22:54 внутренние системы мониторинга начали генерировать предупреждения, указывающие на то, что системы испытывают многочисленные сбои. В это время несколько инженеров отвечали и работали над сортировкой входящих уведомлений. К 23:02 инженеры из группы быстрого реагирования определили, что топологии для многочисленных кластеров баз данных находятся в неожиданном состоянии.

6. Реакция 

	Была выбрана стратегия, которая заключалась в том, чтобы уделять приоритетное внимание целостности данных, а не удобству использования сайта. Поэтому, время восстановления было долгим (в случае быстрого восстановления часть данных пользователей была бы потеряна).

7. Восстановление 

	- Созданы резервыне копии, и из них восстановлены данные
	- Синхронизированы реплики на обоих сайтах
	- Вернулись к стабильной топологии кластеров БД
	- Возобновили обработку заданий, поставленных в очередь.

8. Таймлайн 

	- 22:52 сетевой сбой при замене вышедшего из строя оптического оборудования
	- 22:54 внутренние системы мониторинга начали генерировать предупреждения о многочисленных сбоях
	- 23:02 инженеры из группы быстрого реагирования определили, что топологии для многочисленных кластеров баз данных находятся в неожиданном состоянии
	- 23:07 отвечающая команда решила вручную заблокировать внутренний инструментарий развертывания, чтобы предотвратить внесение каких-либо дополнительных изменений
	- 23:09 группа реагирования присвоила сайту желтый статус
	- 23:11 присоединился координатор инцидента и через две минуты изменил решение на красный статус
	- 23:13 Были вызваны дополнительные инженеры из команды разработчиков баз данных GitHub. Они начали исследовать текущее состояние, чтобы определить, какие действия необходимо предпринять, чтобы вручную настроить базу данных Восточного побережья США в качестве основной для каждого кластера и перестроить топологию репликации.
	- 00:05 Инженеры, участвующие в группе реагирования на инциденты, начали разрабатывать план устранения несоответствий данных и внедрения процедур отработки отказа для MySQL.
	- 00:41 был запущен процесс резервного копирования для всех затронутых кластеров MySQL, и инженеры отслеживали прогресс.
	- 06:51 Несколько кластеров завершили восстановление из резервных копий в нашем центре обработки данных на Восточном побережье США и начали репликацию новых данных с Западного побережья.
	- 11:12 Все первичные базы данных снова созданы на Восточном побережье США. Это привело к тому, что сайт стал гораздо более отзывчивым, поскольку записи теперь направлялись на сервер базы данных, который был расположен в том же физическом центре обработки данных, что и уровень приложений. 
	- 16:24 Как только реплики были синхронизированы, выполнили переход на исходную топологию, решив непосредственные проблемы с задержкой / доступностью.
	- 23:03 Все незавершенные сборки вебхуков и страниц были обработаны, и целостность и правильная работа всех систем были подтверждены. Статус сайта был изменен на зеленый.

9. Последующие действия 

	- Ручная досинхронизация небольшого количества данных, которые не были реплицированы при изменении топологии кластеров БД во время сбоя.
	- Изменение конфигурации Orchestrator, чтобы предотвратить автоматическое переключение первичнойго севереа БД с Восточного на Западное побережье США.
	- Введение независимых статусов инцидентов (желтый, красный, зеленый) для каждого из независимых компонентов платформы GitHub
